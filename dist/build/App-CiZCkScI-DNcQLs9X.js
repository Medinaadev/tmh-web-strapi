import{hp as st,d as W,r as q,u as B,b_ as nt,b$ as rt,j as t,P as Z,hq as oe,R as it,a as Me,F as C,c as Ee,as as lt,ap as Le,n as de,a3 as Pe,q as ce,aO as Ie,hr as ot,f$ as $e,hs as dt,g2 as ct,bo as Ne,t as xe,ba as Be,b as ne,S as N,be as ut,es as X,B as ie,b3 as ft,aR as ee,gj as gt,G as ht,bi as mt,ht as pt,bn as Fe,hu as be,hv as yt,hw as xt,b8 as je,bj as bt,bk as jt,g1 as ke,M as _,N as vt,O as Rt,U as I,X as wt,ab as Mt,T as j,ac as Ct,al as St,hx as Tt,aW as Dt,aX as At,bX as Ue,bY as He,Q as Ce,a4 as zt,eP as ve,bl as re,hy as Ot,hz as Et,bt as Lt,gl as Pt,cf as It,hA as $t,hB as Nt,L as We,b7 as Qe,ae as Bt,af as Ft,aQ as K,A as kt,E as V,hC as Ut,hD as fe,cu as Ht,an as Q,hE as Wt,aE as Qt,hF as _t,hG as Re,au as J,c4 as Y,e0 as Gt}from"./strapi-CGTkTAmZ.js";import{f as pe}from"./index-BXM-uXgM.js";import{t as Yt,a as qt,R as Zt,z as Xt}from"./schemas-DdA2ic2U-Q6hbn0IB.js";import{f as Kt}from"./index-BFTZRrLo.js";import"./index-BRVyLNfZ.js";function _e(s,e,n){var a=Yt(s,n),i=qt(e,a,!0),r=new Date(a.getTime()-i),d=new Date(0);return d.setFullYear(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate()),d.setHours(r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds()),d}var Vt=String.prototype.replace,Jt=/%20/g,ge={RFC1738:"RFC1738",RFC3986:"RFC3986"},we={default:ge.RFC3986,formatters:{RFC1738:function(s){return Vt.call(s,Jt,"+")},RFC3986:function(s){return String(s)}},RFC1738:ge.RFC1738,RFC3986:ge.RFC3986},ea=we,he=Object.prototype.hasOwnProperty,G=Array.isArray,k=function(){for(var s=[],e=0;e<256;++e)s.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return s}(),ta=function(e){for(;e.length>1;){var n=e.pop(),a=n.obj[n.prop];if(G(a)){for(var i=[],r=0;r<a.length;++r)typeof a[r]<"u"&&i.push(a[r]);n.obj[n.prop]=i}}},Ge=function(e,n){for(var a=n&&n.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(a[i]=e[i]);return a},aa=function s(e,n,a){if(!n)return e;if(typeof n!="object"){if(G(e))e.push(n);else if(e&&typeof e=="object")(a&&(a.plainObjects||a.allowPrototypes)||!he.call(Object.prototype,n))&&(e[n]=!0);else return[e,n];return e}if(!e||typeof e!="object")return[e].concat(n);var i=e;return G(e)&&!G(n)&&(i=Ge(e,a)),G(e)&&G(n)?(n.forEach(function(r,d){if(he.call(e,d)){var l=e[d];l&&typeof l=="object"&&r&&typeof r=="object"?e[d]=s(l,r,a):e.push(r)}else e[d]=r}),e):Object.keys(n).reduce(function(r,d){var l=n[d];return he.call(r,d)?r[d]=s(r[d],l,a):r[d]=l,r},i)},sa=function(e,n){return Object.keys(n).reduce(function(a,i){return a[i]=n[i],a},e)},na=function(s,e,n){var a=s.replace(/\+/g," ");if(n==="iso-8859-1")return a.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(a)}catch{return a}},ra=function(e,n,a,i,r){if(e.length===0)return e;var d=e;if(typeof e=="symbol"?d=Symbol.prototype.toString.call(e):typeof e!="string"&&(d=String(e)),a==="iso-8859-1")return escape(d).replace(/%u[0-9a-f]{4}/gi,function(h){return"%26%23"+parseInt(h.slice(2),16)+"%3B"});for(var l="",c=0;c<d.length;++c){var o=d.charCodeAt(c);if(o===45||o===46||o===95||o===126||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||r===ea.RFC1738&&(o===40||o===41)){l+=d.charAt(c);continue}if(o<128){l=l+k[o];continue}if(o<2048){l=l+(k[192|o>>6]+k[128|o&63]);continue}if(o<55296||o>=57344){l=l+(k[224|o>>12]+k[128|o>>6&63]+k[128|o&63]);continue}c+=1,o=65536+((o&1023)<<10|d.charCodeAt(c)&1023),l+=k[240|o>>18]+k[128|o>>12&63]+k[128|o>>6&63]+k[128|o&63]}return l},ia=function(e){for(var n=[{obj:{o:e},prop:"o"}],a=[],i=0;i<n.length;++i)for(var r=n[i],d=r.obj[r.prop],l=Object.keys(d),c=0;c<l.length;++c){var o=l[c],h=d[o];typeof h=="object"&&h!==null&&a.indexOf(h)===-1&&(n.push({obj:d,prop:o}),a.push(h))}return ta(n),e},la=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},oa=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},da=function(e,n){return[].concat(e,n)},ca=function(e,n){if(G(e)){for(var a=[],i=0;i<e.length;i+=1)a.push(n(e[i]));return a}return n(e)},Ye={arrayToObject:Ge,assign:sa,combine:da,compact:ia,decode:na,encode:ra,isBuffer:oa,isRegExp:la,maybeMap:ca,merge:aa},qe=st,le=Ye,se=we,ua=Object.prototype.hasOwnProperty,Se={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,n){return e+"["+n+"]"},repeat:function(e){return e}},H=Array.isArray,fa=Array.prototype.push,Ze=function(s,e){fa.apply(s,H(e)?e:[e])},ga=Date.prototype.toISOString,Te=se.default,A={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:le.encode,encodeValuesOnly:!1,format:Te,formatter:se.formatters[Te],indices:!1,serializeDate:function(e){return ga.call(e)},skipNulls:!1,strictNullHandling:!1},ha=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},me={},ma=function s(e,n,a,i,r,d,l,c,o,h,b,u,g,y,x,R){for(var m=e,O=R,T=0,p=!1;(O=O.get(me))!==void 0&&!p;){var F=O.get(e);if(T+=1,typeof F<"u"){if(F===T)throw new RangeError("Cyclic object value");p=!0}typeof O.get(me)>"u"&&(T=0)}if(typeof c=="function"?m=c(n,m):m instanceof Date?m=b(m):a==="comma"&&H(m)&&(m=le.maybeMap(m,function(U){return U instanceof Date?b(U):U})),m===null){if(r)return l&&!y?l(n,A.encoder,x,"key",u):n;m=""}if(ha(m)||le.isBuffer(m)){if(l){var D=y?n:l(n,A.encoder,x,"key",u);return[g(D)+"="+g(l(m,A.encoder,x,"value",u))]}return[g(n)+"="+g(String(m))]}var w=[];if(typeof m>"u")return w;var E;if(a==="comma"&&H(m))y&&l&&(m=le.maybeMap(m,l)),E=[{value:m.length>0?m.join(",")||null:void 0}];else if(H(c))E=c;else{var $=Object.keys(m);E=o?$.sort(o):$}for(var L=i&&H(m)&&m.length===1?n+"[]":n,z=0;z<E.length;++z){var f=E[z],v=typeof f=="object"&&typeof f.value<"u"?f.value:m[f];if(!(d&&v===null)){var M=H(m)?typeof a=="function"?a(L,f):L:L+(h?"."+f:"["+f+"]");R.set(e,T);var P=qe();P.set(me,R),Ze(w,s(v,M,a,i,r,d,a==="comma"&&y&&H(m)?null:l,c,o,h,b,u,g,y,x,P))}}return w},pa=function(e){if(!e)return A;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=e.charset||A.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var a=se.default;if(typeof e.format<"u"){if(!ua.call(se.formatters,e.format))throw new TypeError("Unknown format option provided.");a=e.format}var i=se.formatters[a],r=A.filter;return(typeof e.filter=="function"||H(e.filter))&&(r=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:A.addQueryPrefix,allowDots:typeof e.allowDots>"u"?A.allowDots:!!e.allowDots,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:A.charsetSentinel,delimiter:typeof e.delimiter>"u"?A.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:A.encode,encoder:typeof e.encoder=="function"?e.encoder:A.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:A.encodeValuesOnly,filter:r,format:a,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:A.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:A.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:A.strictNullHandling}},ya=function(s,e){var n=s,a=pa(e),i,r;typeof a.filter=="function"?(r=a.filter,n=r("",n)):H(a.filter)&&(r=a.filter,i=r);var d=[];if(typeof n!="object"||n===null)return"";var l;e&&e.arrayFormat in Se?l=e.arrayFormat:e&&"indices"in e?l=e.indices?"indices":"repeat":l="indices";var c=Se[l];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var o=c==="comma"&&e&&e.commaRoundTrip;i||(i=Object.keys(n)),a.sort&&i.sort(a.sort);for(var h=qe(),b=0;b<i.length;++b){var u=i[b];a.skipNulls&&n[u]===null||Ze(d,ma(n[u],u,c,o,a.strictNullHandling,a.skipNulls,a.encode?a.encoder:null,a.filter,a.sort,a.allowDots,a.serializeDate,a.format,a.formatter,a.encodeValuesOnly,a.charset,h))}var g=d.join(a.delimiter),y=a.addQueryPrefix===!0?"?":"";return a.charsetSentinel&&(a.charset==="iso-8859-1"?y+="utf8=%26%2310003%3B&":y+="utf8=%E2%9C%93&"),g.length>0?y+g:""},te=Ye,ye=Object.prototype.hasOwnProperty,xa=Array.isArray,S={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:te.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},ba=function(s){return s.replace(/&#(\d+);/g,function(e,n){return String.fromCharCode(parseInt(n,10))})},Xe=function(s,e){return s&&typeof s=="string"&&e.comma&&s.indexOf(",")>-1?s.split(","):s},ja="utf8=%26%2310003%3B",va="utf8=%E2%9C%93",Ra=function(e,n){var a={},i=n.ignoreQueryPrefix?e.replace(/^\?/,""):e,r=n.parameterLimit===1/0?void 0:n.parameterLimit,d=i.split(n.delimiter,r),l=-1,c,o=n.charset;if(n.charsetSentinel)for(c=0;c<d.length;++c)d[c].indexOf("utf8=")===0&&(d[c]===va?o="utf-8":d[c]===ja&&(o="iso-8859-1"),l=c,c=d.length);for(c=0;c<d.length;++c)if(c!==l){var h=d[c],b=h.indexOf("]="),u=b===-1?h.indexOf("="):b+1,g,y;u===-1?(g=n.decoder(h,S.decoder,o,"key"),y=n.strictNullHandling?null:""):(g=n.decoder(h.slice(0,u),S.decoder,o,"key"),y=te.maybeMap(Xe(h.slice(u+1),n),function(x){return n.decoder(x,S.decoder,o,"value")})),y&&n.interpretNumericEntities&&o==="iso-8859-1"&&(y=ba(y)),h.indexOf("[]=")>-1&&(y=xa(y)?[y]:y),ye.call(a,g)?a[g]=te.combine(a[g],y):a[g]=y}return a},wa=function(s,e,n,a){for(var i=a?e:Xe(e,n),r=s.length-1;r>=0;--r){var d,l=s[r];if(l==="[]"&&n.parseArrays)d=[].concat(i);else{d=n.plainObjects?Object.create(null):{};var c=l.charAt(0)==="["&&l.charAt(l.length-1)==="]"?l.slice(1,-1):l,o=parseInt(c,10);!n.parseArrays&&c===""?d={0:i}:!isNaN(o)&&l!==c&&String(o)===c&&o>=0&&n.parseArrays&&o<=n.arrayLimit?(d=[],d[o]=i):c!=="__proto__"&&(d[c]=i)}i=d}return i},Ma=function(e,n,a,i){if(e){var r=a.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,d=/(\[[^[\]]*])/,l=/(\[[^[\]]*])/g,c=a.depth>0&&d.exec(r),o=c?r.slice(0,c.index):r,h=[];if(o){if(!a.plainObjects&&ye.call(Object.prototype,o)&&!a.allowPrototypes)return;h.push(o)}for(var b=0;a.depth>0&&(c=l.exec(r))!==null&&b<a.depth;){if(b+=1,!a.plainObjects&&ye.call(Object.prototype,c[1].slice(1,-1))&&!a.allowPrototypes)return;h.push(c[1])}return c&&h.push("["+r.slice(c.index)+"]"),wa(h,n,a,i)}},Ca=function(e){if(!e)return S;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=typeof e.charset>"u"?S.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?S.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:S.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:S.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:S.arrayLimit,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:S.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:S.comma,decoder:typeof e.decoder=="function"?e.decoder:S.decoder,delimiter:typeof e.delimiter=="string"||te.isRegExp(e.delimiter)?e.delimiter:S.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:S.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:S.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:S.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:S.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:S.strictNullHandling}},Sa=function(s,e){var n=Ca(e);if(s===""||s===null||typeof s>"u")return n.plainObjects?Object.create(null):{};for(var a=typeof s=="string"?Ra(s,n):s,i=n.plainObjects?Object.create(null):{},r=Object.keys(a),d=0;d<r.length;++d){var l=r[d],c=Ma(l,a[l],n,typeof s=="string");i=te.merge(i,c,n)}return n.allowSparse===!0?i:te.compact(i)},Ta=ya,Da=Sa,Aa=we,za={formats:Aa,parse:Da,stringify:Ta};const Oa=W(C)`
  width: 100%;
  max-width: 256px;

  & > * {
    border-bottom: 1px solid ${({theme:s})=>s.colors.neutral150};
  }

  & > *:last-child {
    border-bottom: none;
  }
`,Ea=({action:s,status:e,hasErrors:n,requiredStage:a,entryStage:i})=>{const{formatMessage:r}=B();return s==="publish"?n||a&&a.id!==i?.id?t.jsx(Q.Trigger,{children:t.jsx(N,{variant:"ghost",startIcon:t.jsx(Re,{fill:"danger600"}),endIcon:t.jsx(J,{}),children:t.jsx(j,{textColor:"danger600",variant:"omega",fontWeight:"bold",children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.not-ready",defaultMessage:"Not ready to publish"})})})}):e==="draft"?t.jsx(Q.Trigger,{children:t.jsx(N,{variant:"ghost",startIcon:t.jsx(Y,{fill:"success600"}),endIcon:t.jsx(J,{}),children:t.jsx(j,{textColor:"success600",variant:"omega",fontWeight:"bold",children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.ready-to-publish",defaultMessage:"Ready to publish"})})})}):e==="modified"?t.jsx(Q.Trigger,{children:t.jsx(N,{variant:"ghost",startIcon:t.jsx(Gt,{fill:"alternative600"}),endIcon:t.jsx(J,{}),children:t.jsx(j,{variant:"omega",fontWeight:"bold",textColor:"alternative600",children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.modified",defaultMessage:"Ready to publish changes"})})})}):t.jsx(Q.Trigger,{children:t.jsx(N,{variant:"ghost",startIcon:t.jsx(Y,{fill:"success600"}),endIcon:t.jsx(J,{}),children:t.jsx(j,{textColor:"success600",variant:"omega",fontWeight:"bold",children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.already-published",defaultMessage:"Already published"})})})}):e==="published"?t.jsx(Q.Trigger,{children:t.jsx(N,{variant:"ghost",startIcon:t.jsx(Y,{fill:"success600"}),endIcon:t.jsx(J,{}),children:t.jsx(j,{textColor:"success600",variant:"omega",fontWeight:"bold",children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.ready-to-unpublish",defaultMessage:"Ready to unpublish"})})})}):t.jsx(Q.Trigger,{children:t.jsx(N,{variant:"ghost",startIcon:t.jsx(Y,{fill:"success600"}),endIcon:t.jsx(J,{}),children:t.jsx(j,{textColor:"success600",variant:"omega",fontWeight:"bold",children:r({id:"content-releases.pages.ReleaseDetails.entry-validation.already-unpublished",defaultMessage:"Already unpublished"})})})})},La=({hasErrors:s,errors:e,kind:n,contentTypeUid:a,documentId:i,locale:r})=>{const{formatMessage:d}=B();return t.jsxs(C,{direction:"column",gap:1,width:"100%",padding:5,children:[t.jsxs(C,{gap:2,width:"100%",children:[t.jsx(j,{fontWeight:"bold",children:d({id:"content-releases.pages.ReleaseDetails.entry-validation.fields",defaultMessage:"Fields"})}),s?t.jsx(Re,{fill:"danger600"}):t.jsx(Y,{fill:"success600"})]}),t.jsx(j,{width:"100%",textColor:"neutral600",children:s?d({id:"content-releases.pages.ReleaseDetails.entry-validation.fields.error",defaultMessage:"{errors} errors on fields."},{errors:e?Object.keys(e).length:0}):d({id:"content-releases.pages.ReleaseDetails.entry-validation.fields.success",defaultMessage:"All fields are filled correctly."})}),s&&t.jsx(We,{tag:Qe,to:{pathname:`/content-manager/${n==="collectionType"?"collection-types":"single-types"}/${a}/${i}`,search:r?za.stringify({plugins:{i18n:{locale:r}}}):""},variant:"secondary",fullWidth:!0,state:{forceValidation:!0},children:d({id:"content-releases.pages.ReleaseDetails.entry-validation.fields.see-errors",defaultMessage:"See errors"})})]})},Pa=({contentTypeHasReviewWorkflow:s,requiredStage:e,entryStage:n})=>s?e&&e.id!==n?.id?t.jsx(Re,{fill:"danger600"}):t.jsx(Y,{fill:"success600"}):t.jsx(Y,{fill:"neutral200"}),Ia=({contentTypeHasReviewWorkflow:s,requiredStage:e,entryStage:n,formatMessage:a})=>s?e&&e.id!==n?.id?a({id:"content-releases.pages.ReleaseDetails.entry-validation.review-stage.not-ready",defaultMessage:"This entry is not at the required stage for publishing. ({stageName})"},{stageName:e?.name??""}):e&&e.id===n?.id?a({id:"content-releases.pages.ReleaseDetails.entry-validation.review-stage.ready",defaultMessage:"This entry is at the required stage for publishing. ({stageName})"},{stageName:e?.name??""}):a({id:"content-releases.pages.ReleaseDetails.entry-validation.review-stage.stage-not-required",defaultMessage:"No required stage for publication"}):a({id:"content-releases.pages.ReleaseDetails.entry-validation.review-stage.not-enabled",defaultMessage:"This entry is not associated to any workflow."}),$a=({contentTypeHasReviewWorkflow:s,requiredStage:e,entryStage:n})=>{const{formatMessage:a}=B(),i=Pa({contentTypeHasReviewWorkflow:s,requiredStage:e,entryStage:n});return t.jsxs(C,{direction:"column",gap:1,width:"100%",padding:5,children:[t.jsxs(C,{gap:2,width:"100%",children:[t.jsx(j,{fontWeight:"bold",children:a({id:"content-releases.pages.ReleaseDetails.entry-validation.review-stage",defaultMessage:"Review stage"})}),i]}),t.jsx(j,{textColor:"neutral600",children:Ia({contentTypeHasReviewWorkflow:s,requiredStage:e,entryStage:n,formatMessage:a})})]})},Na=({schema:s,entry:e,status:n,action:a})=>{const{validate:i,isLoading:r}=Ht({collectionType:s?.kind??"",model:s?.uid??""},{skip:!0}),d=r?null:i(e),l=d?Object.keys(d).length>0:!1,c=s?.hasReviewWorkflow??!1,o=s?.stageRequiredToPublish,h=e.strapi_stage;return r?null:t.jsxs(Q.Root,{children:[t.jsx(Ea,{action:a,status:n,hasErrors:l,requiredStage:o,entryStage:h}),t.jsx(Q.Content,{children:t.jsxs(Oa,{direction:"column",children:[t.jsx(La,{hasErrors:l,errors:d,contentTypeUid:s?.uid,kind:s?.kind,documentId:e.documentId,locale:e.locale}),t.jsx($a,{contentTypeHasReviewWorkflow:c,requiredStage:o,entryStage:h})]})})]})},Ba=["years","months","days","hours","minutes","seconds"],Ke=q.forwardRef(({timestamp:s,customIntervals:e=[],...n},a)=>{const{formatRelativeTime:i,formatDate:r,formatTime:d}=B(),l=nt({start:s,end:Date.now()}),c=Ba.find(u=>l[u]>0&&Object.keys(l).includes(u)),o=rt(s)?-l[c]:l[c],h=e.find(u=>l[u.unit]<u.threshold),b=h?h.text:i(o,c,{numeric:"auto"});return t.jsx("time",{ref:a,dateTime:s.toISOString(),role:"time",title:`${r(s)} ${d(s)}`,...n,children:b})}),Ve=({handleClose:s,open:e,handleSubmit:n,initialValues:a,isLoading:i=!1})=>{const{formatMessage:r}=B(),{pathname:d}=Le(),l=d===`/plugins/${Wt}`,{timezoneList:c,systemTimezone:o={value:"UTC+00:00-Africa/Abidjan "}}=ke(a.scheduledAt?new Date(a.scheduledAt):new Date),h=u=>{const{date:g,time:y,timezone:x}=u;if(!g||!y||!x)return null;const R=x.split("&")[1];return Xt(`${g} ${y}`,R)},b=()=>c.find(g=>g.value.split("&")[1]===a.timezone)?.value||o.value;return t.jsx(_.Root,{open:e,onOpenChange:s,children:t.jsxs(_.Content,{children:[t.jsx(_.Header,{children:t.jsx(_.Title,{children:r({id:"content-releases.modal.title",defaultMessage:"{isCreatingRelease, select, true {New release} other {Edit release}}"},{isCreatingRelease:l})})}),t.jsx(vt,{onSubmit:u=>{n({...u,timezone:u.timezone?u.timezone.split("&")[1]:null,scheduledAt:u.isScheduled?h(u):null})},initialValues:{...a,timezone:a.timezone?b():o.value},validationSchema:Zt,validateOnChange:!1,children:({values:u,errors:g,handleChange:y,setFieldValue:x})=>t.jsxs(Rt,{children:[t.jsx(_.Body,{children:t.jsxs(C,{direction:"column",alignItems:"stretch",gap:6,children:[t.jsxs(I.Root,{name:"name",error:g.name&&r({id:g.name,defaultMessage:g.name}),required:!0,children:[t.jsx(I.Label,{children:r({id:"content-releases.modal.form.input.label.release-name",defaultMessage:"Name"})}),t.jsx(wt,{value:u.name,onChange:y}),t.jsx(I.Error,{})]}),t.jsx(ie,{width:"max-content",children:t.jsx(Mt,{name:"isScheduled",checked:u.isScheduled,onCheckedChange:R=>{x("isScheduled",R),R?(x("date",a.date),x("time",a.time),x("timezone",a.timezone??o?.value)):(x("date",null),x("time",""),x("timezone",null))},children:t.jsx(j,{textColor:u.isScheduled?"primary600":"neutral800",fontWeight:u.isScheduled?"semiBold":"regular",children:r({id:"modal.form.input.label.schedule-release",defaultMessage:"Schedule release"})})})}),u.isScheduled&&t.jsxs(t.Fragment,{children:[t.jsxs(C,{gap:4,alignItems:"start",children:[t.jsx(ie,{width:"100%",children:t.jsxs(I.Root,{name:"date",error:g.date&&r({id:g.date,defaultMessage:g.date}),required:!0,children:[t.jsx(I.Label,{children:r({id:"content-releases.modal.form.input.label.date",defaultMessage:"Date"})}),t.jsx(Ct,{onChange:R=>{const m=R?Kt(R,{representation:"date"}):null;x("date",m)},clearLabel:r({id:"content-releases.modal.form.input.clearLabel",defaultMessage:"Clear"}),onClear:()=>{x("date",null)},value:u.date?new Date(u.date):new Date,minDate:_e(new Date,u.timezone.split("&")[1])}),t.jsx(I.Error,{})]})}),t.jsx(ie,{width:"100%",children:t.jsxs(I.Root,{name:"time",error:g.time&&r({id:g.time,defaultMessage:g.time}),required:!0,children:[t.jsx(I.Label,{children:r({id:"content-releases.modal.form.input.label.time",defaultMessage:"Time"})}),t.jsx(St,{onChange:R=>{x("time",R)},clearLabel:r({id:"content-releases.modal.form.input.clearLabel",defaultMessage:"Clear"}),onClear:()=>{x("time","")},value:u.time||void 0}),t.jsx(I.Error,{})]})})]}),t.jsx(Fa,{timezoneOptions:c})]})]})}),t.jsxs(_.Footer,{children:[t.jsx(_.Close,{children:t.jsx(N,{variant:"tertiary",name:"cancel",children:r({id:"cancel",defaultMessage:"Cancel"})})}),t.jsx(N,{name:"submit",loading:i,type:"submit",children:r({id:"content-releases.modal.form.button.submit",defaultMessage:"{isCreatingRelease, select, true {Continue} other {Save}}"},{isCreatingRelease:l})})]})]})})]})})},Fa=({timezoneOptions:s})=>{const{values:e,errors:n,setFieldValue:a}=Tt(),{formatMessage:i}=B(),[r,d]=q.useState(s);return q.useEffect(()=>{if(e.date){const{timezoneList:l}=ke(new Date(e.date));d(l);const c=e.timezone&&l.find(o=>o.value.split("&")[1]===e.timezone.split("&")[1]);c&&a("timezone",c.value)}},[a,e.date,e.timezone]),t.jsxs(I.Root,{name:"timezone",error:n.timezone&&i({id:n.timezone,defaultMessage:n.timezone}),required:!0,children:[t.jsx(I.Label,{children:i({id:"content-releases.modal.form.input.label.timezone",defaultMessage:"Timezone"})}),t.jsx(Dt,{autocomplete:{type:"list",filter:"contains"},value:e.timezone||void 0,textValue:e.timezone?e.timezone.replace(/&/," "):void 0,onChange:l=>{a("timezone",l)},onTextValueChange:l=>{a("timezone",l)},onClear:()=>{a("timezone","")},children:r.map(l=>t.jsx(At,{value:l.value,children:l.value.replace(/&/," ")},l.value))}),t.jsx(I.Error,{})]})},ka=Qt,Je=s=>typeof s<"u"&&s.name!==void 0,Ua=W(Ee)`
  display: block;
`,Ha=W(Ke)`
  display: inline-block;
  &::first-letter {
    text-transform: uppercase;
  }
`,et=s=>{let e;switch(s){case"ready":e="success";break;case"blocked":e="warning";break;case"failed":e="danger";break;case"done":e="primary";break;case"empty":default:e="neutral"}return{textColor:`${e}600`,backgroundColor:`${e}100`,borderColor:`${e}200`}},De=({sectionTitle:s,releases:e=[],isError:n=!1})=>{const{formatMessage:a}=B();return n?t.jsx(Z.Error,{}):e?.length===0?t.jsx(Ue,{content:a({id:"content-releases.page.Releases.tab.emptyEntries",defaultMessage:"No releases"},{target:s}),icon:t.jsx(He,{width:"16rem"})}):t.jsx(Ce.Root,{gap:4,children:e.map(({id:i,name:r,scheduledAt:d,status:l})=>t.jsx(Ce.Item,{col:3,s:6,xs:12,direction:"column",alignItems:"stretch",children:t.jsx(Ua,{tag:zt,to:`${i}`,isExternal:!1,children:t.jsxs(C,{direction:"column",justifyContent:"space-between",padding:4,hasRadius:!0,background:"neutral0",shadow:"tableShadow",height:"100%",width:"100%",alignItems:"start",gap:4,children:[t.jsxs(C,{direction:"column",alignItems:"start",gap:1,children:[t.jsx(j,{textColor:"neutral800",tag:"h3",variant:"delta",fontWeight:"bold",children:r}),t.jsx(j,{variant:"pi",textColor:"neutral600",children:d?t.jsx(Ha,{timestamp:new Date(d)}):a({id:"content-releases.pages.Releases.not-scheduled",defaultMessage:"Not scheduled"})})]}),t.jsx(ve,{...et(l),children:l})]})})},i))})},Wa=W(lt)`
  button {
    display: none;
  }
  p + div {
    margin-left: auto;
  }
`,Qa={name:"",date:pe(new Date,"yyyy-MM-dd"),time:"",isScheduled:!0,scheduledAt:null,timezone:null},_a=()=>{const s=Le(),[e,n]=q.useState(!1),{toggleNotification:a}=de(),{formatMessage:i}=B(),r=Pe(),{formatAPIError:d}=ce(),[{query:l},c]=Ie(),o=ot(l),{data:h,isLoading:b}=$e(),[u,{isLoading:g}]=dt(),{getFeature:y}=ct(),{maximumReleases:x=3}=y("cms-content-releases"),{trackUsage:R}=Ne(),{allowedActions:{canCreate:m}}=xe(oe),{isLoading:O,isSuccess:T,isError:p}=o,F=o?.currentData?.meta?.activeTab||"pending";q.useEffect(()=>{s?.state?.errors&&(a({type:"danger",title:i({id:"content-releases.pages.Releases.notification.error.title",defaultMessage:"Your request could not be processed."}),message:i({id:"content-releases.pages.Releases.notification.error.message",defaultMessage:"Please try again or open another release."})}),r("",{replace:!0,state:null}))},[i,s?.state?.errors,r,a]);const D=()=>{n(z=>!z)};if(O||b)return t.jsx(Z.Loading,{});const w=T&&o.currentData?.meta?.pendingReleasesCount||0,E=w>=x,$=z=>{c({...l,page:1,pageSize:o?.currentData?.meta?.pagination?.pageSize||16,filters:{releasedAt:{$notNull:z!=="pending"}}})},L=async({name:z,scheduledAt:f,timezone:v})=>{const M=await u({name:z,scheduledAt:f,timezone:v});"data"in M?(a({type:"success",message:i({id:"content-releases.modal.release-created-notification-success",defaultMessage:"Release created."})}),R("didCreateRelease"),r(M.data.data.id.toString())):re(M.error)?a({type:"danger",message:d(M.error)}):a({type:"danger",message:i({id:"notification.error",defaultMessage:"An error occurred"})})};return t.jsxs(Be,{"aria-busy":O||b,children:[t.jsx(ne.Header,{title:i({id:"content-releases.pages.Releases.title",defaultMessage:"Releases"}),subtitle:i({id:"content-releases.pages.Releases.header-subtitle",defaultMessage:"Create and manage content updates"}),primaryAction:m?t.jsx(N,{startIcon:t.jsx(ut,{}),onClick:D,disabled:E,children:i({id:"content-releases.header.actions.add-release",defaultMessage:"New release"})}):null}),t.jsx(ne.Content,{children:t.jsxs(t.Fragment,{children:[E&&t.jsx(Wa,{marginBottom:6,action:t.jsx(Ee,{href:"https://strapi.io/pricing-cloud",isExternal:!0,children:i({id:"content-releases.pages.Releases.max-limit-reached.action",defaultMessage:"Explore plans"})}),title:i({id:"content-releases.pages.Releases.max-limit-reached.title",defaultMessage:"You have reached the {number} pending {number, plural, one {release} other {releases}} limit."},{number:x}),onClose:()=>{},closeLabel:"",children:i({id:"content-releases.pages.Releases.max-limit-reached.message",defaultMessage:"Upgrade to manage an unlimited number of releases."})}),t.jsxs(X.Root,{variant:"simple",onValueChange:$,value:F,children:[t.jsxs(ie,{paddingBottom:8,children:[t.jsxs(X.List,{"aria-label":i({id:"content-releases.pages.Releases.tab-group.label",defaultMessage:"Releases list"}),children:[t.jsx(X.Trigger,{value:"pending",children:i({id:"content-releases.pages.Releases.tab.pending",defaultMessage:"Pending ({count})"},{count:w})}),t.jsx(X.Trigger,{value:"done",children:i({id:"content-releases.pages.Releases.tab.done",defaultMessage:"Done"})})]}),t.jsx(ft,{})]}),t.jsx(X.Content,{value:"pending",children:t.jsx(De,{sectionTitle:"pending",releases:o?.currentData?.data,isError:p})}),t.jsx(X.Content,{value:"done",children:t.jsx(De,{sectionTitle:"done",releases:o?.currentData?.data,isError:p})})]}),t.jsxs(ee.Root,{...o?.currentData?.meta?.pagination,defaultPageSize:o?.currentData?.meta?.pagination?.pageSize,children:[t.jsx(ee.PageSize,{options:["8","16","32","64"]}),t.jsx(ee.Links,{})]})]})}),t.jsx(Ve,{open:e,handleClose:D,handleSubmit:L,isLoading:g,initialValues:{...Qa,timezone:h?.data.defaultTimezone?h.data.defaultTimezone.split("&")[1]:null}})]})},Ga=W(C)`
  align-self: stretch;
  border-bottom-right-radius: ${({theme:s})=>s.borderRadius};
  border-bottom-left-radius: ${({theme:s})=>s.borderRadius};
  border-top: 1px solid ${({theme:s})=>s.colors.neutral150};
`,Ae=W(gt)`
  svg path {
    fill: ${({theme:s,disabled:e})=>e&&s.colors.neutral500};
  }
  span {
    color: ${({theme:s,disabled:e})=>e&&s.colors.neutral500};
  }

  &:hover {
    background: ${({theme:s,$variant:e="neutral"})=>s.colors[`${e}100`]};
  }
`,Ya=W(ht)`
  width: ${({theme:s})=>s.spaces[4]};
  height: ${({theme:s})=>s.spaces[4]};
  path {
    fill: ${({theme:s})=>s.colors.neutral600};
  }
`,qa=W(mt)`
  width: ${({theme:s})=>s.spaces[4]};
  height: ${({theme:s})=>s.spaces[4]};
  path {
    fill: ${({theme:s})=>s.colors.danger600};
  }
`,ze=({toggleEditReleaseModal:s,toggleWarningSubmit:e,children:n})=>{const{formatMessage:a,formatDate:i,formatTime:r}=B(),{releaseId:d}=Fe(),{data:l,isLoading:c,error:o}=be({id:d},{skip:!d}),[h,{isLoading:b}]=Ot(),{toggleNotification:u}=de(),{formatAPIError:g}=ce(),{allowedActions:y}=xe(oe),{canUpdate:x,canDelete:R,canPublish:m}=y,O=ka(),{trackUsage:T}=Ne(),p=l?.data,F=v=>async()=>{const M=await h({id:v});if("data"in M){u({type:"success",message:a({id:"content-releases.pages.ReleaseDetails.publish-notification-success",defaultMessage:"Release was published successfully."})});const{totalEntries:P,totalPublishedEntries:U,totalUnpublishedEntries:ae}=M.data.meta;T("didPublishRelease",{totalEntries:P,totalPublishedEntries:U,totalUnpublishedEntries:ae})}else re(M.error)?u({type:"danger",message:g(M.error)}):u({type:"danger",message:a({id:"notification.error",defaultMessage:"An error occurred"})})},D=()=>{O(_t.util.invalidateTags([{type:"ReleaseAction",id:"LIST"},{type:"Release",id:d}]))},w=()=>p?.createdBy?p.createdBy.username?p.createdBy.username:p.createdBy.firstname?`${p.createdBy.firstname} ${p.createdBy.lastname||""}`.trim():p.createdBy.email:null;if(c)return t.jsx(Z.Loading,{});if(Je(o)&&"code"in o||!p)return t.jsx(je,{to:"..",state:{errors:[{code:o?.code}]}});const E=p.actions.meta.count||0,$=!!w(),L=p.scheduledAt&&p.timezone,z=a({id:"content-releases.pages.Details.header-subtitle",defaultMessage:"{number, plural, =0 {No entries} one {# entry} other {# entries}}"},{number:E}),f=L?a({id:"content-releases.pages.ReleaseDetails.header-subtitle.scheduled",defaultMessage:"Scheduled for {date} at {time} ({offset})"},{date:i(new Date(p.scheduledAt),{weekday:"long",day:"numeric",month:"long",year:"numeric",timeZone:p.timezone}),time:r(new Date(p.scheduledAt),{timeZone:p.timezone,hourCycle:"h23"}),offset:Et(p.timezone,new Date(p.scheduledAt))}):"";return t.jsxs(Be,{"aria-busy":c,children:[t.jsx(ne.Header,{title:p.name,subtitle:t.jsxs(C,{gap:2,lineHeight:6,children:[t.jsx(j,{textColor:"neutral600",variant:"epsilon",children:z+(L?` - ${f}`:"")}),t.jsx(ve,{...et(p.status),children:p.status})]}),navigationAction:t.jsx(Lt,{fallback:".."}),primaryAction:!p.releasedAt&&t.jsxs(C,{gap:2,children:[t.jsxs(Za,{label:t.jsx(Pt,{}),variant:"tertiary",endIcon:null,paddingLeft:"7px",paddingRight:"7px","aria-label":a({id:"content-releases.header.actions.open-release-actions",defaultMessage:"Release edit and delete menu"}),popoverPlacement:"bottom-end",children:[t.jsx(Ae,{disabled:!x,onSelect:s,children:t.jsxs(C,{alignItems:"center",gap:2,hasRadius:!0,width:"100%",children:[t.jsx(Ya,{}),t.jsx(j,{ellipsis:!0,children:a({id:"content-releases.header.actions.edit",defaultMessage:"Edit"})})]})}),t.jsx(Ae,{disabled:!R,onSelect:e,$variant:"danger",children:t.jsxs(C,{alignItems:"center",gap:2,hasRadius:!0,width:"100%",children:[t.jsx(qa,{}),t.jsx(j,{ellipsis:!0,textColor:"danger600",children:a({id:"content-releases.header.actions.delete",defaultMessage:"Delete"})})]})}),t.jsxs(Ga,{direction:"column",justifyContent:"center",alignItems:"flex-start",gap:1,padding:4,children:[t.jsx(j,{variant:"pi",fontWeight:"bold",children:a({id:"content-releases.header.actions.created",defaultMessage:"Created"})}),t.jsxs(j,{variant:"pi",color:"neutral300",children:[t.jsx(Ke,{timestamp:new Date(p.createdAt)}),a({id:"content-releases.header.actions.created.description",defaultMessage:"{hasCreatedByUser, select, true { by {createdBy}} other { by deleted user}}"},{createdBy:w(),hasCreatedByUser:$})]})]})]}),t.jsx(N,{size:"S",variant:"tertiary",onClick:D,children:a({id:"content-releases.header.actions.refresh",defaultMessage:"Refresh"})}),m?t.jsx(N,{size:"S",variant:"default",onClick:F(p.id.toString()),loading:b,disabled:p.actions.meta.count===0,children:a({id:"content-releases.header.actions.publish",defaultMessage:"Publish"})}):null]})}),n]})},Za=W(pt)`
  & > span {
    display: flex;
  }
`,Xa=["contentType","locale","action"],Ka=["contentType","action"],Oe=s=>s==="locale"?{id:"content-releases.pages.ReleaseDetails.groupBy.option.locales",defaultMessage:"Locales"}:s==="action"?{id:"content-releases.pages.ReleaseDetails.groupBy.option.actions",defaultMessage:"Actions"}:{id:"content-releases.pages.ReleaseDetails.groupBy.option.content-type",defaultMessage:"Content-Types"},Va=({releaseId:s})=>{const{formatMessage:e}=B(),[{query:n},a]=Ie(),{toggleNotification:i}=de(),{formatAPIError:r}=ce(),{data:d,isLoading:l,error:c}=be({id:s}),{allowedActions:{canUpdate:o}}=xe(oe),h=It("ReleaseDetailsPage",f=>f.runHookWaterfall),{displayedHeaders:b,hasI18nEnabled:u}=h("ContentReleases/pages/ReleaseDetails/add-locale-in-releases",{displayedHeaders:[{label:{id:"content-releases.page.ReleaseDetails.table.header.label.name",defaultMessage:"name"},name:"name"}],hasI18nEnabled:!1}),g=d?.data,y=n?.groupBy||"contentType",{isLoading:x,isFetching:R,isError:m,data:O,error:T}=$t({...n,releaseId:s}),[p]=Nt(),F=async(f,v,M)=>{const P=await p({params:{releaseId:s,actionId:v},body:{type:f.target.value},query:n,actionPath:M});"error"in P&&(re(P.error)?i({type:"danger",message:r(P.error)}):i({type:"danger",message:e({id:"notification.error",defaultMessage:"An error occurred"})}))};if(x||l)return t.jsx(Z.Loading,{});const D=O?.data,w=O?.meta,E=w?.contentTypes||{};if(w?.components,Je(c)||!g){const f=[];return c&&"code"in c&&f.push({code:c.code}),T&&"code"in T&&f.push({code:T.code}),t.jsx(je,{to:"..",state:{errors:f}})}if(m||!D)return t.jsx(Z.Error,{});if(Object.keys(D).length===0)return t.jsx(ne.Content,{children:t.jsx(Ue,{action:t.jsx(We,{tag:Qe,to:{pathname:"/content-manager"},style:{textDecoration:"none"},variant:"secondary",children:e({id:"content-releases.page.Details.button.openContentManager",defaultMessage:"Open the Content Manager"})}),icon:t.jsx(He,{width:"16rem"}),content:e({id:"content-releases.pages.Details.tab.emptyEntries",defaultMessage:"This release is empty. Open the Content Manager, select an entry and add it to the release."})})});const $=e({id:"content-releases.pages.ReleaseDetails.groupBy.aria-label",defaultMessage:"Group by"}),L=[...b,{label:{id:"content-releases.page.ReleaseDetails.table.header.label.content-type",defaultMessage:"content-type"},name:"content-type"},{label:{id:"content-releases.page.ReleaseDetails.table.header.label.action",defaultMessage:"action"},name:"action"},...g.releasedAt?[]:[{label:{id:"content-releases.page.ReleaseDetails.table.header.label.status",defaultMessage:"status"},name:"status"}]],z=u?Xa:Ka;return t.jsx(ne.Content,{children:t.jsxs(C,{gap:8,direction:"column",alignItems:"stretch",children:[t.jsx(C,{children:t.jsx(Bt,{placeholder:$,"aria-label":$,customizeContent:f=>e({id:"content-releases.pages.ReleaseDetails.groupBy.label",defaultMessage:"Group by {groupBy}"},{groupBy:f}),value:e(Oe(y)),onChange:f=>a({groupBy:f}),children:z.map(f=>t.jsx(Ft,{value:f,children:e(Oe(f))},f))})}),Object.keys(D).map(f=>t.jsxs(C,{gap:4,direction:"column",alignItems:"stretch",children:[t.jsx(C,{role:"separator","aria-label":f,children:t.jsx(ve,{children:f})}),t.jsx(K.Root,{rows:D[f].map(v=>({...v,id:Number(v.entry.id)})),headers:L,isLoading:x||R,children:t.jsxs(K.Content,{children:[t.jsx(K.Head,{children:L.map(({label:v,name:M})=>t.jsx(K.HeaderCell,{label:e(v),name:M},M))}),t.jsx(K.Loading,{}),t.jsx(K.Body,{children:D[f].map(({id:v,contentType:M,locale:P,type:U,entry:ae,status:tt},at)=>t.jsxs(kt,{children:[t.jsx(V,{width:"25%",maxWidth:"200px",children:t.jsx(j,{ellipsis:!0,children:`${M.mainFieldValue||ae.id}`})}),u&&t.jsx(V,{width:"10%",children:t.jsx(j,{children:`${P?.name?P.name:"-"}`})}),t.jsx(V,{width:"10%",children:t.jsx(j,{children:M.displayName||""})}),t.jsx(V,{width:"20%",children:g.releasedAt?t.jsx(j,{children:e({id:"content-releases.page.ReleaseDetails.table.action-published",defaultMessage:"This entry was <b>{isPublish, select, true {published} other {unpublished}}</b>."},{isPublish:U==="publish",b:ue=>t.jsx(j,{fontWeight:"bold",children:ue})})}):t.jsx(Ut,{selected:U,handleChange:ue=>F(ue,v,[f,at]),name:`release-action-${v}-type`,disabled:!o})}),!g.releasedAt&&t.jsxs(t.Fragment,{children:[t.jsx(V,{width:"20%",minWidth:"200px",children:t.jsx(Na,{action:U,schema:E?.[M.uid],entry:ae,status:tt})}),t.jsx(V,{children:t.jsx(C,{justifyContent:"flex-end",children:t.jsxs(fe.Root,{children:[t.jsx(fe.ReleaseActionEntryLinkItem,{contentTypeUid:M.uid,documentId:ae.documentId,locale:P?.code}),t.jsx(fe.DeleteReleaseActionItem,{releaseId:g.id,actionId:v})]})})})]})]},v))})]})})]},`releases-group-${f}`)),t.jsxs(ee.Root,{...w?.pagination,defaultPageSize:w?.pagination?.pageSize,children:[t.jsx(ee.PageSize,{}),t.jsx(ee.Links,{})]})]})})},Ja=()=>{const{formatMessage:s}=B(),{releaseId:e}=Fe(),{toggleNotification:n}=de(),{formatAPIError:a}=ce(),i=Pe(),[r,d]=q.useState(!1),[l,c]=q.useState(!1),{isLoading:o,data:h,isSuccess:b}=be({id:e},{skip:!e}),{data:u,isLoading:g}=$e(),[y,{isLoading:x}]=yt(),[R]=xt(),m=()=>{d(f=>!f)},O=()=>p?.timezone?p.timezone:u?.data.defaultTimezone?u.data.defaultTimezone:null,T=()=>c(f=>!f);if(o||g)return t.jsx(ze,{toggleEditReleaseModal:m,toggleWarningSubmit:T,children:t.jsx(Z.Loading,{})});if(!e)return t.jsx(je,{to:".."});const p=b&&h?.data||null,F=p?.name||"",D=O(),w=p?.scheduledAt&&D?_e(p.scheduledAt,D):null,E=w?pe(w,"yyyy-MM-dd"):void 0,$=w?pe(w,"HH:mm"):"",L=async f=>{const v=await y({id:e,name:f.name,scheduledAt:f.scheduledAt,timezone:f.timezone});"data"in v?(n({type:"success",message:s({id:"content-releases.modal.release-updated-notification-success",defaultMessage:"Release updated."})}),m()):re(v.error)?n({type:"danger",message:a(v.error)}):n({type:"danger",message:s({id:"notification.error",defaultMessage:"An error occurred"})})},z=async()=>{const f=await R({id:e});"data"in f?i(".."):re(f.error)?n({type:"danger",message:a(f.error)}):n({type:"danger",message:s({id:"notification.error",defaultMessage:"An error occurred"})})};return t.jsxs(ze,{toggleEditReleaseModal:m,toggleWarningSubmit:T,children:[t.jsx(Va,{releaseId:e}),t.jsx(Ve,{open:r,handleClose:m,handleSubmit:L,isLoading:o||x,initialValues:{name:F||"",scheduledAt:w,date:E,time:$,isScheduled:!!w,timezone:D}}),t.jsx(bt.Root,{open:l,onOpenChange:T,children:t.jsx(jt,{onConfirm:z,children:s({id:"content-releases.dialog.confirmation-message",defaultMessage:"Are you sure you want to delete this release?"})})})]})},rs=()=>t.jsx(Z.Protect,{permissions:oe.main,children:t.jsxs(it,{children:[t.jsx(Me,{index:!0,element:t.jsx(_a,{})}),t.jsx(Me,{path:":releaseId",element:t.jsx(Ja,{})})]})});export{rs as App};
